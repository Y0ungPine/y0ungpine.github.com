---
layout : post
title : 加密解密系列之MD5
categories : 加密解密
tags : MD5 加密
---
!TOC

为了深入的学习加密解密，开一个加密算法系列，这是第一篇**MD5**。

MD5，消息摘要算法第五版（英语：Message-Digest Algorithm 5，缩写为MD5），是当前计算机领域用于确保信息传输完整一致而广泛使用的**散列算法**之一（又译哈希算法、摘要算法等），主流编程语言普遍已有MD5的实现。

将数据（如一段文字）运算变为另一固定长度值，是散列算法的基础原理，MD5的前身有MD2、MD3和MD4。

#MD5的历史 
---
1992年8月，罗纳德·李维斯特向IETF提交了一份重要文件，描述了这种算法的原理，由于这种算法的公开性和安全性，在90年代被广泛使用在各种程序语言中，用以确保资料传递无误等。

MD5由MD4、MD3、MD2改进而来，主要增强算法复杂度和不可逆性。

目前，MD5算法因其普遍、稳定、快速的特点，仍广泛应用于普通数据的错误检查领域。例如在一些BitTorrent下载中，软件将通过计算MD5检验下载到的文件片段的完整性。

#MD5的用途
---
1. 防止被篡改：
   1. 比如发送一个电子文档，发送前，我先得到MD5的输出结果a。然后在对方收到电子文档后，对方也得到一个MD5的输出结果b。如果a与b一样就代表中途未被篡改。
   2. 比如我提供文件下载，为了防止不法分子在安装程序中添加木马，我可以在网站上公布由安装文件得到的MD5输出结果。
   3. SVN在检测文件是否在CheckOut后被修改过，也是用到了MD5.

2. 防止直接看到明文：现在很多网站在数据库存储用户的密码的时候都是存储用户密码的MD5值。这样就算不法分子得到数据库的用户密码的MD5值，也无法知道用户的密码(其实这样是不安全的，后面我会提到)。（比如在UNIX系统中用户的密码就是以MD5（或其它类似的算法）经加密后存储在文件系统中。当用户登录的时候，系统把用户输入的密码计算成MD5值，然后再去和保存在文件系统中的MD5值进行比较，进而确定输入的密码是否正确。通过这样的步骤，系统在并不知道用户密码的明码的情况下就可以确定用户登录系统的合法性。这不但可以避免用户的密码被具有系统管理员权限的用户知道，而且还在一定程度上增加了密码被破解的难度。）

3. 防止抵赖（数字签名）：这需要一个第三方认证机构。例如A写了一个文件，认证机构对此文件用MD5算法产生摘要信息并做好记录。若以后A说这文件不是他写的，权威机构只需对此文件重新产生摘要信息，然后跟记录在册的摘要信息进行比对，相同的话，就证明是A写的了。这就是所谓的“数字签名”。

#什么是单向散列函数？
---
单项散列函数H(M)作用于任意长度的消息M，它返回一固定长度的散列值h:**h=H(M)**，其中h的长度为m。

输入任意长度且输出固定长度的函数有很多种，但是单项散列函数还具有使其单向的如下特性：
   
   * 给定M，很容易计算h。
   * 给定h，根据H(M)=h计算M很难。
   * 给定M，要找到另一个消息M'并满足H(M)=H(M')很难。

#针对单项散列函数的攻击--生日攻击
---
对单项散列函数的攻击方式有两种。

第一种，给定消息的散列函数H(M)，破译者能够逐个产生其他文件M'，使得H(M)=H(M')。

第二种，攻击者找出两个随机的消息M，M'，并使得H(M)=H(M')。这就是所谓的冲突攻击（collision），要比第一种来的容易。

生日悖论是一个标准的统计问题。房子里有多少人才至少有一个人和你生日相同，答案是253。那么有多少人才能使他们中至少两人生日相同，答案是23，对于仅有23人的屋子里，在屋子里仍有253个不同队的人。寻找特定生日的方法是第一种攻击方式，寻找至少两个相同生日的人时第二种攻击方式。第二种方法通常被称作**生日攻击**（birthday attack）。

#MD2
---

#MD3
---

#MD4
---

#MD5算法
---
对MD5算法简要的叙述可以为：MD5以512位分组来处理输入的信息，且每一分组又被划分为16个32位子分组，经过了一系列的处理后，算法的输出由四个32位分组组成，将这四个32位分组级联后将生成一个128位散列值。基本方式为求余、取余、调整长度、与链接变量进行循环运算。得出结果。


#MD5算法的不足
---
现在看来，MD5已经较老，散列长度通常为128位，随着计算机运算能力提高，找到“碰撞”是可能的。因此，在安全要求高的场合不使用MD5。

2004年，王小云教授证明MD5数字签名算法可以产生碰撞。2007年，Marc Stevens，Arjen K. Lenstra和Benne de Weger进一步指出通过伪造软件签名，可重复性攻击MD5算法。研究者使用前缀碰撞法（chosen-prefix collision），使程序前端包含恶意程序，利用后面的空间添上垃圾代码凑出同样的MD5 Hash值。2007年，荷兰埃因霍芬技术大学科学家成功把2个可执行文件进行了MD5碰撞，使得这两个运行结果不同的程序被计算出同一个MD5。2008年12月科研人员通过MD5碰撞成功生成了伪造的SSL证书，这使得在https协议中服务器可以伪造一些根CA的签名。

MD5被攻破后，在Crypto2008上， Rivest提出了MD6算法，该算法的Block size为512 bytes(MD5的Block Size是512 bits), Chaining value长度为1024 bits, 算法增加了并行机制，适合于多核CPU。 在安全性上，Rivest宣称该算法能够抵抗截至目前已知的所有的攻击（包括差分攻击）。


#参考文献
---
1. 应用密码学：协议、算法与C源程序
2. http://zh.wikipedia.org/wiki/MD5
1. http://blog.csdn.net/forgotaboutgirl/article/details/7258109
4. http://blog.sina.com.cn/s/blog_64ffd1280101ehs0.html